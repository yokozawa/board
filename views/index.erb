<div class="container">

<h1>tasks</h1>
<ul id="sortable-li">
  <% @tasks.each do |task|  %>
    <li data-id="<%= task.id %>" id="<%= task.id %>" >
      <a href="#" id="<%= task.id %>" class="ui-state-default" data-name="task" data-type="text" data-pk="<%= task.id %>" data-url="/edit" data-title="enter">
        <%= task.body %>
      </a>
      <span class="deleteCmd" style="float: right; cursor:pointer; color:blue">[x]</span>
    </li>
  <% end %>
</ul>

<h2>add new</h2>
<form method="post" action="/new">
<input type="text" name="body"><input type="submit" value="submit!">
</form>



<script>
$.fn.editable.defaults.mode = 'inline';
$(document).ready(function() {
  var el = $(this);
  $('.ui-state-default').editable({
  	type: 'text',
  	pk: el.data('id'),
  	value: el.data('text'),
  });
});


$('.deleteCmd').click(function(){
  var el = $(this).parent();
  $.post('/delete', {
    id: el.data('id')
  }, function() {
    el.fadeOut(800)
  });
  return false;
})

$(function(){
  $('#sortable-li').sortable({
    update: function(event, ui){
      var ids = $('#sortable-li').sortable('toArray');
      $.post('/sort',{ids: ids});
    }
  });
});
</script>

</div>
